# GPIO ë²„íŠ¼ ì œì–´ ê°€ì´ë“œ (ë‹¨ì¼ ë²„íŠ¼ + Gemini ë©€í‹°ëª¨ë‹¬)

## ê°œìš”
ë¼ì¦ˆë² ë¦¬íŒŒì´ ìŠ¤íƒ ë“œì–¼ë¡  í™˜ê²½ì—ì„œ **ë‹¨ í•˜ë‚˜ì˜ ë²„íŠ¼**ìœ¼ë¡œ ëª¨ë“  ê¸°ëŠ¥ì„ ìŒì„±ìœ¼ë¡œ ì œì–´í•©ë‹ˆë‹¤.
Gemini ë©€í‹°ëª¨ë‹¬ ê¸°ëŠ¥ìœ¼ë¡œ ì˜¤ë””ì˜¤ë¥¼ ì§ì ‘ ì²˜ë¦¬í•˜ì—¬ STT ë¼ì´ë¸ŒëŸ¬ë¦¬ ì—†ì´ ë™ì‘í•©ë‹ˆë‹¤.

## í•˜ë“œì›¨ì–´ ì—°ê²°

### ë²„íŠ¼ í•€ ë°°ì¹˜
```
GPIO 17 (Pin 11) : ìŒì„± ë…¹ìŒ ë²„íŠ¼
GND            : ì ‘ì§€
```

### íšŒë¡œ ì—°ê²°ë„
```
[GPIO 17] ----[ë²„íŠ¼]---- [GND]
```

**ì£¼ì˜**: ë‚´ë¶€ í’€ì—… ì €í•­(PULL-UP)ì„ ì‚¬ìš©í•˜ë¯€ë¡œ ì™¸ë¶€ ì €í•­ ë¶ˆí•„ìš”

## ì‘ë™ ë°©ì‹

### ë‹¨ì¼ ë²„íŠ¼ í† ê¸€ ë™ì‘
1. **ì²« ë²ˆì§¸ ë²„íŠ¼ ëˆ„ë¦„** â†’ ë…¹ìŒ ì‹œì‘ (í™”ë©´ì— "RECORDING..." í‘œì‹œ)
2. **ë§í•˜ëŠ” ë™ì•ˆ** â†’ ê³„ì† ë…¹ìŒ ì§„í–‰
3. **ë‘ ë²ˆì§¸ ë²„íŠ¼ ëˆ„ë¦„** â†’ ë…¹ìŒ ì¢…ë£Œ ë° Gemini ë¶„ì„
4. **Gemini ë¶„ì„** â†’ ìŒì„± ë‚´ìš©ì„ ë¶„ì„í•˜ì—¬ ëª…ë ¹ ì‹¤í–‰
5. **ê²°ê³¼ ë°˜ì˜** â†’ ê·¸ë˜í”„ ì¶”ê°€/ì‚­ì œ/í† ê¸€ ìë™ ì‹¤í–‰

### ì¥ì 
- â±ï¸ **ì‹œê°„ ì œí•œ ì—†ìŒ**: ì›í•˜ëŠ” ë§Œí¼ ë§í•  ìˆ˜ ìˆìŒ
- ğŸ¯ **ì •í™•í•œ íƒ€ì´ë°**: ë§ì„ ë‹¤ í•œ í›„ ë²„íŠ¼ìœ¼ë¡œ ì¢…ë£Œ
- ğŸ”„ **ì§ê´€ì **: ëˆ„ë¥´ë©´ ì‹œì‘, ë‹¤ì‹œ ëˆ„ë¥´ë©´ ì¢…ë£Œ

### Gemini ë©€í‹°ëª¨ë‹¬ ì²˜ë¦¬
- **STT ë¶ˆí•„ìš”**: SpeechRecognition ë¼ì´ë¸ŒëŸ¬ë¦¬ ì‚¬ìš© ì•ˆ í•¨
- **ì§ì ‘ ì˜¤ë””ì˜¤ ì²˜ë¦¬**: WAV íŒŒì¼ì„ Geminiì— ì§ì ‘ ì „ì†¡
- **ìì—°ì–´ ì´í•´**: Geminiê°€ ìŒì„± ë‚´ìš©ì„ ì´í•´í•˜ê³  JSON ëª…ë ¹ ìƒì„±
- **ë‹¤êµ­ì–´ ì§€ì›**: í•œêµ­ì–´, ì˜ì–´ ìë™ ì¸ì‹

## ìŒì„± ëª…ë ¹ ì˜ˆì‹œ

### 1. ê·¸ë˜í”„ ì¶”ê°€
```
"x ì œê³±"
"ì‚¬ì¸ í•¨ìˆ˜"
"ì½”ì‚¬ì¸ x"
"xì˜ ì„¸ì œê³±"
"ì¼ì°¨ í•¨ìˆ˜"
"í¬ë¬¼ì„  ê·¸ë ¤ì¤˜"
```

### 2. ê·¸ë˜í”„ ì‚­ì œ
```
"ë§ˆì§€ë§‰ ì‚­ì œ"
"ë§ˆì§€ë§‰ ì§€ì›Œ"
"ê·¸ë˜í”„ ì‚­ì œ"
"ì „ë¶€ ì‚­ì œ"
"ëª¨ë‘ ì§€ì›Œ"
"ë‹¤ ì§€ì›Œ"
```

### 3. ê·¸ë˜í”„ í‘œì‹œ/ìˆ¨ê¹€
```
"ì²« ë²ˆì§¸ ìˆ¨ê²¨"
"ë‘ ë²ˆì§¸ ë³´ì—¬ì¤˜"
"ì„¸ ë²ˆì§¸ ê·¸ë˜í”„ í† ê¸€"
```

## ì„¤ì • ë³€ê²½

`config/config.yaml` íŒŒì¼ì—ì„œ GPIO í•€ ë²ˆí˜¸ ë³€ê²½ ê°€ëŠ¥:

```yaml
buttons:
  record_pin: 17   # ìŒì„± ë…¹ìŒ ë²„íŠ¼
```

## ì‚¬ìš© ì‹œë‚˜ë¦¬ì˜¤

### ì‹œë‚˜ë¦¬ì˜¤ 1: ì²« ë²ˆì§¸ ê·¸ë˜í”„ ì¶”ê°€
1. ì‹œìŠ¤í…œ ë¶€íŒ… ë° ì‹¤í–‰
2. **ë²„íŠ¼ ëˆ„ë¦„** (ë…¹ìŒ ì‹œì‘)
3. "x ì œê³±"ì´ë¼ê³  ë§í•¨
4. **ë²„íŠ¼ ë‹¤ì‹œ ëˆ„ë¦„** (ë…¹ìŒ ì¢…ë£Œ)
5. Geminiê°€ ë¶„ì„ â†’ í™”ë©´ì— í¬ë¬¼ì„  ê·¸ë˜í”„ í‘œì‹œ

### ì‹œë‚˜ë¦¬ì˜¤ 2: ì—¬ëŸ¬ ê·¸ë˜í”„ ë™ì‹œ ê´€ë¦¬
1. **ë²„íŠ¼ ëˆ„ë¦„** â†’ "x ì œê³±" â†’ **ë²„íŠ¼ ëˆ„ë¦„**
2. **ë²„íŠ¼ ëˆ„ë¦„** â†’ "ì‚¬ì¸ x" â†’ **ë²„íŠ¼ ëˆ„ë¦„**
3. **ë²„íŠ¼ ëˆ„ë¦„** â†’ "ì½”ì‚¬ì¸ x" â†’ **ë²„íŠ¼ ëˆ„ë¦„**
4. 3ê°œì˜ ê·¸ë˜í”„ê°€ ë‹¤ë¥¸ ìƒ‰ìƒìœ¼ë¡œ í‘œì‹œë¨

### ì‹œë‚˜ë¦¬ì˜¤ 3: ê¸´ ëª…ë ¹ë„ ê°€ëŠ¥
1. **ë²„íŠ¼ ëˆ„ë¦„** (ë…¹ìŒ ì‹œì‘)
2. "xì˜ ì„¸ì œê³±ì—ì„œ 2ê³±í•˜ê¸° xë¥¼ ë¹¼ê³  1ì„ ë”í•œ í•¨ìˆ˜ë¥¼ ê·¸ë ¤ì¤˜"
3. **ë²„íŠ¼ ëˆ„ë¦„** (ë…¹ìŒ ì¢…ë£Œ)
4. Geminiê°€ ë³µì¡í•œ ëª…ë ¹ë„ ì´í•´í•˜ì—¬ ì²˜ë¦¬

### ì‹œë‚˜ë¦¬ì˜¤ 4: ìŒì„±ìœ¼ë¡œ ì‚­ì œ
1. ì—¬ëŸ¬ ê·¸ë˜í”„ í‘œì‹œ ì¤‘
2. **ë²„íŠ¼ ëˆ„ë¦„** â†’ "ë§ˆì§€ë§‰ ì§€ì›Œ" â†’ **ë²„íŠ¼ ëˆ„ë¦„**
3. ê°€ì¥ ìµœê·¼ ê·¸ë˜í”„ ìë™ ì‚­ì œ

### ì‹œë‚˜ë¦¬ì˜¤ 5: ìŒì„±ìœ¼ë¡œ ì „ì²´ ì´ˆê¸°í™”
1. ë³µì¡í•œ ê·¸ë˜í”„ ì—¬ëŸ¬ ê°œ í‘œì‹œ ì¤‘
2. **ë²„íŠ¼ ëˆ„ë¦„** â†’ "ì „ë¶€ ì‚­ì œ" â†’ **ë²„íŠ¼ ëˆ„ë¦„**
3. ëª¨ë“  ê·¸ë˜í”„ í•œ ë²ˆì— ì‚­ì œ

### ì‹œë‚˜ë¦¬ì˜¤ 6: íŠ¹ì • ê·¸ë˜í”„ ìˆ¨ê¹€
1. ê·¸ë˜í”„ 3ê°œ í‘œì‹œ ì¤‘
2. **ë²„íŠ¼ ëˆ„ë¦„** â†’ "ì²« ë²ˆì§¸ ìˆ¨ê²¨" â†’ **ë²„íŠ¼ ëˆ„ë¦„**
3. ì²« ë²ˆì§¸ ê·¸ë˜í”„ë§Œ ìˆ¨ê¹€ ì²˜ë¦¬

## ë¹„ìƒ ì¢…ë£Œ
- **ESC í‚¤**: í‚¤ë³´ë“œ ì—°ê²° ì‹œ ë¹„ìƒ ì¢…ë£Œ ê°€ëŠ¥ (ê°œë°œ/í…ŒìŠ¤íŠ¸ìš©)
- **Ctrl+C**: í„°ë¯¸ë„ì—ì„œ ê°•ì œ ì¢…ë£Œ

## ê¸°ìˆ  êµ¬ì¡°

### Gemini ë©€í‹°ëª¨ë‹¬ í”Œë¡œìš°
```
[ì²« ë²ˆì§¸ ë²„íŠ¼ ëˆ„ë¦„] 
    â†“
[ë…¹ìŒ ì‹œì‘ (í™”ë©´ì— RECORDING í‘œì‹œ)]
    â†“
[ì‚¬ìš©ìê°€ ë§í•˜ëŠ” ë™ì•ˆ ê³„ì† ë…¹ìŒ]
    â†“
[ë‘ ë²ˆì§¸ ë²„íŠ¼ ëˆ„ë¦„]
    â†“
[ë…¹ìŒ ì¢…ë£Œ ë° WAV ìƒì„±]
    â†“
[Gemini API ì—…ë¡œë“œ]
    â†“
[Gemini ìŒì„± ë¶„ì„]
    â†“
[JSON ëª…ë ¹ ìƒì„±]
    â†“
[ëª…ë ¹ ì‹¤í–‰]
```

### GeminiAudioAgent í´ë˜ìŠ¤
```python
class GeminiAudioAgent:
    def start_recording(self) -> bool:
        # ë…¹ìŒ ì‹œì‘ (ë…¼ë¸”ë¡œí‚¹)
    
    def record_chunk(self):
        # ë©”ì¸ ë£¨í”„ì—ì„œ ì²­í¬ ë‹¨ìœ„ë¡œ ì½ê¸°
    
    def stop_recording(self) -> bytes:
        # ë…¹ìŒ ì¢…ë£Œ ë° WAV ë°˜í™˜
    
    def process_audio_command(self, audio_data: bytes) -> dict:
        # Geminiì— ì˜¤ë””ì˜¤ ì „ì†¡ ë° ëª…ë ¹ íŒŒì‹±
```

### ëª…ë ¹ JSON í˜•ì‹
```json
{
  "action": "add_graph",
  "name": "ì œê³±í•¨ìˆ˜",
  "equation_str": "xÂ²",
  "lambda_str": "lambda x: x**2"
}
```

## íŠ¸ëŸ¬ë¸”ìŠˆíŒ…

### ë²„íŠ¼ì´ ë°˜ì‘í•˜ì§€ ì•Šì„ ë•Œ
1. **GPIO í•€ ë²ˆí˜¸ í™•ì¸**: BCM ëª¨ë“œ ì‚¬ìš© (ë¬¼ë¦¬ í•€ ë²ˆí˜¸ ì•„ë‹˜)
2. **ì—°ê²° í™•ì¸**: GNDì™€ GPIO 17ì´ ì˜¬ë°”ë¥´ê²Œ ì—°ê²°ë˜ì—ˆëŠ”ì§€ í™•ì¸
3. **ê¶Œí•œ í™•ì¸**: `sudo python3 main.py` ì‹¤í–‰
4. **ë¡œê·¸ í™•ì¸**: "âœ“ GPIO ë²„íŠ¼ ì´ˆê¸°í™”" ë©”ì‹œì§€ í™•ì¸

### ìŒì„± ì¸ì‹ì´ ì‘ë™í•˜ì§€ ì•Šì„ ë•Œ
1. **ë§ˆì´í¬ ì—°ê²° í™•ì¸**:
   ```bash
   arecord -l
   ```
2. **Gemini API í‚¤ í™•ì¸**:
   ```bash
   echo $GEMINI_API_KEY
   ```
3. **ì¸í„°ë„· ì—°ê²°**: Gemini API í˜¸ì¶œ í•„ìš”
4. **ë…¹ìŒ ì‹œê°„**: 5ì´ˆ ë‚´ì— ëª…ë ¹ì„ ë§í•´ì•¼ í•¨

### ë…¹ìŒì´ ì‹œì‘ë˜ì§€ ì•Šì„ ë•Œ
1. **ë²„íŠ¼ í™•ì¸**: GPIO 17ì´ ì˜¬ë°”ë¥´ê²Œ ì—°ê²°ë˜ì—ˆëŠ”ì§€
2. **ë¡œê·¸ í™•ì¸**: "ğŸ¤ ë…¹ìŒ ì‹œì‘..." ë©”ì‹œì§€ê°€ ë‚˜ì˜¤ëŠ”ì§€
3. **í™”ë©´ í™•ì¸**: "RECORDING..." í…ìŠ¤íŠ¸ê°€ í‘œì‹œë˜ëŠ”ì§€

### ë…¹ìŒì´ ì¢…ë£Œë˜ì§€ ì•Šì„ ë•Œ
- **ë²„íŠ¼ ë‹¤ì‹œ ëˆ„ë¥´ê¸°**: ë‘ ë²ˆì§¸ ë²„íŠ¼ ëˆ„ë¦„ìœ¼ë¡œ ì¢…ë£Œ
- **ë¡œê·¸ í™•ì¸**: "âœ“ ë…¹ìŒ ì™„ë£Œ (X.Xì´ˆ)" ë©”ì‹œì§€ í™•ì¸

### ë„ˆë¬´ ì§§ê²Œ ë…¹ìŒë  ë•Œ
- **ì¶©ë¶„íˆ ë§í•˜ê¸°**: ìµœì†Œ 1-2ì´ˆ ì´ìƒ ë§í•˜ê¸°
- **ì²œì²œíˆ ë§í•˜ê¸°**: ë˜ë°•ë˜ë°• ë°œìŒ

## ì˜ì¡´ì„± ì„¤ì¹˜

```bash
# Gemini API
pip install google-generativeai

# PyAudio (ë…¹ìŒ)
sudo apt-get install portaudio19-dev
pip install pyaudio

# ê¸°íƒ€
pip install opencv-python numpy mediapipe RPi.GPIO pyyaml
```

## Gemini API í‚¤ ì„¤ì •

### ë°©ë²• 1: í™˜ê²½ë³€ìˆ˜
```bash
export GEMINI_API_KEY="your_api_key_here"
echo 'export GEMINI_API_KEY="your_api_key_here"' >> ~/.bashrc
```

### ë°©ë²• 2: config.yaml
```yaml
gemini:
  api_key: "your_api_key_here"
```

## í•˜ë“œì›¨ì–´ ì¶”ì²œ

### ë²„íŠ¼
- **íƒ€ì…**: ìˆœê°„ ì ‘ì´‰ í‘¸ì‹œ ë²„íŠ¼ (Momentary Push Button)
- **ê·œê²©**: 12x12mm íƒíŠ¸ ìŠ¤ìœ„ì¹˜ (í° ë²„íŠ¼ ê¶Œì¥)
- **ìƒ‰ìƒ**: ë¹¨ê°„ìƒ‰ (ë…¹ìŒ í‘œì‹œ)

### ë§ˆì´í¬
- **íƒ€ì…**: USB ë§ˆì´í¬ (í”ŒëŸ¬ê·¸ ì•¤ í”Œë ˆì´)
- **ì¶”ì²œ**: 
  - Blue Yeti Nano
  - Samson Go Mic
  - Logitech ë°ìŠ¤í¬íƒ‘ ë§ˆì´í¬
- **ìœ„ì¹˜**: ì‚¬ìš©ìë¡œë¶€í„° 30cm ì´ë‚´

### ì¼€ì´ìŠ¤
- ë²„íŠ¼ 1ê°œë¥¼ ì¥ì°©í•  ìˆ˜ ìˆëŠ” ì‘ì€ ì¼€ì´ìŠ¤
- ë¼ì¦ˆë² ë¦¬íŒŒì´ GPIO ì ‘ê·¼ ê°€ëŠ¥í•œ êµ¬ì¡°
- LED ì¶”ê°€ ê°€ëŠ¥ (ë…¹ìŒ ìƒíƒœ í‘œì‹œ)

## ì‹œìŠ¤í…œ ìë™ ì‹œì‘

```bash
# systemd ì„œë¹„ìŠ¤ íŒŒì¼ ìƒì„±
sudo nano /etc/systemd/system/haptic-graph.service
```

```ini
[Unit]
Description=Math Graph Haptic Feedback System
After=network.target

[Service]
Type=simple
User=pi
WorkingDirectory=/home/pi/hackerton
Environment="GEMINI_API_KEY=your_api_key_here"
ExecStart=/usr/bin/python3 /home/pi/hackerton/main.py
Restart=on-failure
RestartSec=5

[Install]
WantedBy=multi-user.target
```

```bash
# ì„œë¹„ìŠ¤ í™œì„±í™”
sudo systemctl enable haptic-graph.service
sudo systemctl start haptic-graph.service
```

## ì¶”ê°€ ê¸°ëŠ¥ í™•ì¥ ì•„ì´ë””ì–´

### LED ì¸ë””ì¼€ì´í„° ì¶”ê°€
```python
# GPIO 27: ë…¹ìŒ ì¤‘ ë¹¨ê°„ LED
# GPIO 22: ì²˜ë¦¬ ì¤‘ ë…¸ë€ LED
# GPIO 23: ì™„ë£Œ ì´ˆë¡ LED
```

### ë²„íŠ¼ ê¸¸ê²Œ ëˆ„ë¥´ê¸°
- **ì§§ê²Œ ëˆ„ë¦„**: 5ì´ˆ ë…¹ìŒ
- **ê¸¸ê²Œ ëˆ„ë¦„ (3ì´ˆ ì´ìƒ)**: ì‹œìŠ¤í…œ ì¢…ë£Œ

### ì†Œë¦¬ í”¼ë“œë°±
- ë²„íŠ¼ ëˆ„ë¦„: "ì‚" ì†Œë¦¬
- ë…¹ìŒ ì‹œì‘: "ëµ" ì†Œë¦¬
- ëª…ë ¹ ì¸ì‹: "ë”©ë™" ì†Œë¦¬

## ë¹„ìš© íš¨ìœ¨ì„±

### Gemini API ê°€ê²© (2025ë…„ ê¸°ì¤€)
- **gemini-1.5-flash**: ë§¤ìš° ì €ë ´
- **ì˜¤ë””ì˜¤ ì²˜ë¦¬**: 5ì´ˆ ë…¹ìŒ = ì•½ $0.0001
- **ì›” 1000íšŒ ì‚¬ìš©**: ì•½ $0.10

### SpeechRecognition ëŒ€ë¹„ ì¥ì 
- âœ… ë³„ë„ STT ë¼ì´ë¸ŒëŸ¬ë¦¬ ë¶ˆí•„ìš”
- âœ… ìì—°ì–´ ì´í•´ ëŠ¥ë ¥ ìš°ìˆ˜
- âœ… ë‹¤êµ­ì–´ ìë™ ì§€ì›
- âœ… ì»¨í…ìŠ¤íŠ¸ ì´í•´ ê°€ëŠ¥

## ì°¸ê³  ìë£Œ
- [Raspberry Pi GPIO Pinout](https://pinout.xyz/)
- [RPi.GPIO Documentation](https://sourceforge.net/p/raspberry-gpio-python/wiki/Home/)
- [Google Gemini API](https://ai.google.dev/)
- [Gemini Multimodal Audio](https://ai.google.dev/gemini-api/docs/audio)
- [PyAudio Documentation](https://people.csail.mit.edu/hubert/pyaudio/)
